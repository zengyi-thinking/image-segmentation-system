# 图像分割系统用户手册

## 1. 系统简介

图像分割系统是一个基于图论的图像分割工具，使用最小生成树(MST)算法实现高质量的图像分割。系统提供了直观的图形用户界面和强大的命令行工具。

### 主要功能
- 基于MST的图像分割算法
- 实时参数调整
- 多种可视化模式
- 性能分析工具
- 分割质量评估

## 2. 安装指南

### 系统要求
- Python 3.8 或更高版本
- Windows/Linux/macOS 操作系统
- 至少 4GB 内存

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd image-segmentation-system
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **验证安装**
```bash
python test_system.py
```

## 3. 快速开始

### GUI模式（推荐）

1. **启动程序**
```bash
python main.py --gui
```

2. **加载图像**
   - 点击"选择图像"按钮
   - 选择支持的图像格式（JPG, PNG, BMP等）

3. **调整参数**
   - 颜色权重(α): 控制颜色相似性的重要程度
   - 空间权重(β): 控制空间距离的重要程度
   - 连接性: 选择4-连通或8-连通
   - 分割阈值: 自动计算或手动设置

4. **执行分割**
   - 点击"开始分割"按钮
   - 等待处理完成
   - 查看分割结果

### 命令行模式

```bash
python main.py --cli --input path/to/image.jpg --output path/to/result.png
```

**参数说明：**
- `--input`: 输入图像路径
- `--output`: 输出图像路径
- `--threshold`: 分割阈值
- `--alpha`: 颜色权重
- `--beta`: 空间权重
- `--connectivity`: 连接性（4或8）

## 4. 界面说明

### 主界面布局

```
┌─────────────────────────────────────────────────────────┐
│  菜单栏: 文件 | 工具 | 帮助                              │
├─────────────┬───────────────────────────────────────────┤
│             │                                           │
│  控制面板   │           图像显示区域                    │
│             │                                           │
│  - 图像加载 │  ┌─────────────────────────────────────┐  │
│  - 参数设置 │  │  原始图像 | 分割结果 | 边界显示    │  │
│  - 执行控制 │  │                                     │  │
│  - 结果信息 │  │                                     │  │
│             │  └─────────────────────────────────────┘  │
├─────────────┴───────────────────────────────────────────┤
│  状态栏: 显示当前操作状态                                │
└─────────────────────────────────────────────────────────┘
```

### 控制面板详解

#### 图像加载区域
- **选择图像**: 打开文件对话框选择图像
- **图像信息**: 显示图像尺寸和文件名

#### 参数设置区域
- **颜色权重(α)**: 范围0.1-5.0，默认1.0
  - 值越大，颜色相似性越重要
  - 适用于颜色区分明显的图像
  
- **空间权重(β)**: 范围0.01-1.0，默认0.1
  - 值越大，空间距离越重要
  - 有助于保持区域的空间连续性
  
- **连接性**: 4-连通或8-连通
  - 4-连通：只考虑上下左右邻居
  - 8-连通：考虑8个方向的邻居
  
- **分割阈值**: 自动计算或手动设置
  - 阈值越小，分割越细致
  - 阈值越大，分割越粗糙

#### 执行控制
- **开始分割**: 执行分割算法
- **进度条**: 显示处理进度

#### 结果信息
显示分割结果的统计信息：
- 分割参数
- 区域数量
- 平均区域大小
- 最大/最小区域大小

### 图像显示区域

#### 原始图像标签页
显示加载的原始图像

#### 分割结果标签页
显示彩色编码的分割结果：
- 每个分割区域用不同颜色表示
- 颜色随机分配，便于区分

#### 边界显示标签页
显示分割边界：
- 红色线条表示分割边界
- 叠加在原始图像上

## 5. 参数调优指南

### 颜色权重(α)调优
- **低值(0.1-0.5)**: 适用于纹理丰富的图像
- **中值(0.5-2.0)**: 适用于一般自然图像
- **高值(2.0-5.0)**: 适用于颜色区分明显的图像

### 空间权重(β)调优
- **低值(0.01-0.05)**: 主要基于颜色分割
- **中值(0.05-0.2)**: 平衡颜色和空间信息
- **高值(0.2-1.0)**: 强调空间连续性

### 连接性选择
- **4-连通**: 
  - 处理速度快
  - 适用于规则形状的对象
  
- **8-连通**:
  - 分割更精细
  - 适用于复杂形状的对象

### 阈值设置
- **自动模式**: 系统自动计算最优阈值
- **手动模式**: 根据需要精细调整
  - 观察分割结果调整阈值
  - 过小：过度分割
  - 过大：欠分割

## 6. 常见问题

### Q: 分割结果过于细碎怎么办？
A: 
1. 增加分割阈值
2. 减小颜色权重α
3. 增加空间权重β

### Q: 分割结果过于粗糙怎么办？
A:
1. 减小分割阈值
2. 增加颜色权重α
3. 使用8-连通模式

### Q: 处理大图像时程序很慢？
A:
1. 先缩小图像尺寸测试参数
2. 使用4-连通模式
3. 关闭其他占用内存的程序

### Q: 如何保存分割结果？
A:
1. GUI模式：文件菜单 → 保存结果
2. 命令行模式：使用--output参数

### Q: 支持哪些图像格式？
A: 支持常见格式：JPG, JPEG, PNG, BMP, TIFF, TIF

## 7. 高级功能

### 性能分析
通过工具菜单访问性能分析功能：
- 运行时间统计
- 内存使用分析
- 处理速度评估

### 算法对比
比较不同参数设置的效果：
- 多阈值分割对比
- 参数敏感性分析
- 质量指标评估

### 批处理
命令行模式支持批处理多个图像：
```bash
for file in *.jpg; do
    python main.py --cli --input "$file" --output "result_$file"
done
```

## 8. 技术支持

### 错误报告
如遇到问题，请提供：
1. 错误信息截图
2. 输入图像（如可能）
3. 使用的参数设置
4. 系统环境信息

### 性能优化建议
1. 使用SSD硬盘提高IO速度
2. 增加内存容量处理大图像
3. 使用GPU加速（未来版本支持）

### 扩展开发
系统采用模块化设计，支持：
1. 添加新的分割算法
2. 扩展评估指标
3. 自定义可视化方式

## 9. 版本历史

### v1.0 (当前版本)
- 基于MST的图像分割算法
- 完整的GUI界面
- 命令行工具
- 性能评估框架
- 可视化工具

### 未来计划
- GPU加速支持
- 更多分割算法
- 3D图像分割
- 深度学习集成
